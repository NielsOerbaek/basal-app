{$DOMAIN:localhost} {
    # Favicon fallback (browsers request /favicon.ico by default)
    handle /favicon.ico {
        rewrite * /static/img/favicon.png
        root * /srv
        file_server
    }

    # Static files
    handle /static/* {
        root * /srv
        file_server
    }

    # Media files
    handle /media/* {
        root * /srv
        file_server
    }

    # Proxy to Django app
    handle {
        reverse_proxy app:8000
    }

    # Security headers (X-Frame-Options is set by Django, not here, to avoid duplicates)
    header {
        X-Content-Type-Options nosniff
        Referrer-Policy strict-origin-when-cross-origin
    }

    # Logging
    log {
        output stdout
        format console
    }
}
